{% extends '@AcMarcheMercredi/front/layout.html.twig' %}

{% block title %}Erreur - Mercredi{% endblock %}

{% block body -%}

    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card shadow-lg border-0">
                    <div class="card-body text-center p-5">
                        <!-- Custom SVG Illustration - Alert Icon -->
                        <div class="mb-4">
                            <svg width="200" height="200" viewBox="0 0 200 200" fill="none"
                                 xmlns="http://www.w3.org/2000/svg">
                                <!-- Alert triangle -->
                                <path d="M100 40 L160 150 L40 150 Z" fill="#fff3cd" stroke="#ffc107" stroke-width="3"/>
                                <circle cx="100" cy="120" r="4" fill="#856404"/>
                                <rect x="97" y="80" width="6" height="30" rx="3" fill="#856404"/>
                                {% if status_code is defined %}
                                    <text x="100" y="185" font-size="24" font-weight="bold" fill="#856404"
                                          text-anchor="middle">{{ status_code }}</text>
                                {% endif %}
                            </svg>
                        </div>

                        <!-- Error Code Badge -->
                        {% if status_code is defined %}
                            {% set badge_color = status_code >= 500 ? 'bg-danger' : (status_code >= 400 ? 'bg-warning text-dark' : 'bg-info') %}
                            <span class="badge {{ badge_color }} mb-3" style="font-size: 1rem; padding: 0.5rem 1rem;">
                                <i class="fas fa-exclamation-circle"></i> Erreur {{ status_code }}
                            </span>
                        {% else %}
                            <span class="badge bg-warning text-dark mb-3"
                                  style="font-size: 1rem; padding: 0.5rem 1rem;">
                                <i class="fas fa-exclamation-circle"></i> Erreur
                            </span>
                        {% endif %}

                        <!-- Main Heading -->
                        <h1 class="display-4 mb-3" style="color: #212529; font-weight: 700;">
                            {% if status_code is defined and status_code >= 500 %}
                                Problème technique
                            {% elseif status_code is defined and status_code >= 400 %}
                                Demande invalide
                            {% else %}
                                Une erreur s'est produite
                            {% endif %}
                        </h1>

                        <!-- Friendly Message -->
                        <p class="lead text-muted mb-4">
                            L'application a rencontré un problème inattendu.
                            {% if status_code is defined and status_code >= 500 %}
                                Notre équipe technique en a été informée et travaille à résoudre ce problème.
                            {% else %}
                                Nous allons résoudre ce problème dès que possible.
                            {% endif %}
                        </p>

                        <hr class="my-4" style="max-width: 200px; margin: 2rem auto;">

                        <!-- Error Details -->
                        {% if status_code is defined or status_text is defined or exception is defined %}
                            <div class="alert alert-light border" role="alert"
                                 style="max-width: 600px; margin: 0 auto 2rem;">
                                <h6 class="alert-heading">
                                    <i class="fas fa-info-circle text-primary"></i> Détails de l'erreur
                                </h6>
                                <div class="text-start mt-3">
                                    {% if status_code is defined %}
                                        <div class="mb-2">
                                            <strong><i class="fas fa-hashtag"></i> Code :</strong>
                                            <span class="badge bg-secondary">{{ status_code }}</span>
                                        </div>
                                    {% endif %}
                                    {% if status_text is defined %}
                                        <div class="mb-2">
                                            <strong><i class="fas fa-tag"></i> Statut :</strong>
                                            <code>{{ status_text }}</code>
                                        </div>
                                    {% endif %}
                                    {% if exception is defined and exception.message is defined %}
                                        <div class="mb-2">
                                            <strong><i class="fas fa-comment-dots"></i> Message :</strong>
                                            <div class="mt-1 p-2 bg-light rounded">
                                                <small class="text-muted font-monospace">{{ exception.message }}</small>
                                            </div>
                                        </div>
                                    {% endif %}
                                    <div class="mt-3 small text-muted">
                                        <i class="fas fa-clock"></i> {{ "now"|date("d/m/Y à H:i:s") }}
                                    </div>
                                </div>
                            </div>
                        {% endif %}

                        <!-- Helpful Suggestions -->
                        <div class="text-start mb-4" style="max-width: 500px; margin: 0 auto;">
                            <h5 class="mb-3"><i class="fas fa-lightbulb text-warning"></i> Que pouvez-vous faire ?</h5>
                            <ul class="list-unstyled text-muted">
                                {% if status_code is defined and status_code >= 500 %}
                                    <li class="mb-2"><i class="fas fa-redo text-primary"></i> Rafraîchissez la page</li>
                                    <li class="mb-2"><i class="fas fa-clock text-primary"></i> Réessayez dans quelques
                                        minutes
                                    </li>
                                    <li class="mb-2"><i class="fas fa-headset text-primary"></i> Contactez le support si
                                        le problème persiste
                                    </li>
                                {% else %}
                                    <li class="mb-2"><i class="fas fa-search text-primary"></i> Vérifiez l'URL et les
                                        paramètres de votre requête
                                    </li>
                                    <li class="mb-2"><i class="fas fa-arrow-left text-primary"></i> Utilisez le bouton
                                        retour de votre navigateur
                                    </li>
                                    <li class="mb-2"><i class="fas fa-home text-primary"></i> Retournez à la page
                                        d'accueil
                                    </li>
                                {% endif %}
                            </ul>
                        </div>

                        <!-- Action Buttons -->
                        <div class="d-grid gap-2 d-md-flex justify-content-md-center mb-4">
                            <a href="{{ path('mercredi_front_home') }}" class="btn btn-primary btn-lg px-4">
                                <i class="fas fa-home"></i> Page d'accueil
                            </a>
                            <button onclick="history.back()" class="btn btn-outline-secondary btn-lg px-4">
                                <i class="fas fa-arrow-left"></i> Retour
                            </button>
                            {% if status_code is defined and status_code >= 500 %}
                                <button onclick="location.reload()" class="btn btn-outline-primary btn-lg px-4">
                                    <i class="fas fa-sync-alt"></i> Actualiser
                                </button>
                            {% endif %}
                        </div>

                        <!-- Help Section -->
                        <div class="alert alert-info" role="alert" style="max-width: 500px; margin: 0 auto 2rem;">
                            <i class="fas fa-hands-helping"></i>
                            <strong>Besoin d'aide ?</strong> Notre équipe de support est disponible pour vous assister.
                        </div>

                        <!-- Contact Info -->
                        <div class="mt-5 pt-4 border-top">
                            <p class="text-muted mb-2">
                                <i class="fas fa-envelope"></i> Support technique
                            </p>
                            <p class="text-muted small">
                                Si cette erreur persiste, veuillez
                                <a href="{{ path('mercredi_front_home') }}" class="text-decoration-none">contacter notre
                                    équipe</a>
                                en précisant le code d'erreur et l'heure de l'incident.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <style>
        .card {
            border-radius: 15px;
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .alert {
            border-radius: 10px;
        }

        .font-monospace {
            font-family: 'Courier New', monospace;
        }

        code {
            background: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            color: #e83e8c;
        }
    </style>

{% endblock %}
